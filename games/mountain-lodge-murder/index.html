<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì‚°ì¥ì˜ ë¹„ë°€</title>
  <link rel="stylesheet" href="https://unpkg.com/@monogatari/core/dist/engine/core.css">
  <style>
    body { margin: 0; padding: 0; background: #000; color: #fff; font-family: sans-serif; }
    #game-screen { width: 100vw; height: 100vh; }
    #debug-log { position: fixed; top: 10px; left: 10px; font-size: 11px; color: #0f0; background: rgba(0,0,0,0.8); padding: 10px; z-index: 9999; max-height: 80vh; overflow: auto; border: 1px solid #333; }
  </style>
</head>
<body>
  <div id="debug-log">ğŸ” ì—”ì§„ íƒìƒ‰ ì¤‘...</div>
  <div id="game-screen">
    <visual-novel></visual-novel>
  </div>

  <script src="https://unpkg.com/@monogatari/core@2.0.2/dist/monogatari.js"></script>
  
  <script src="js/script.js"></script>

  <script>
    const log = (msg) => { 
      const el = document.getElementById('debug-log');
      el.innerText += "\n" + msg; 
      el.scrollTop = el.scrollHeight;
      console.log("[Debug]", msg); 
    };

    window.addEventListener('load', () => {
      log("ğŸš€ í˜ì´ì§€ ë¡œë”© ì™„ë£Œ");

      // [í•µì‹¬] ëª¨ë“  ê°€ëŠ¥ì„±ì„ ì—´ì–´ë‘ê³  ì—”ì§„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
      let engine = null;

      // 1ìˆœìœ„: ì „ì—­ monogatari
      if (window.monogatari && typeof window.monogatari.init === 'function') {
        engine = window.monogatari;
        log("âœ… ì†Œë¬¸ì monogatari ì¸ìŠ¤í„´ìŠ¤ í™•ë³´");
      } 
      // 2ìˆœìœ„: ì „ì—­ Monogatari
      else if (window.Monogatari) {
        if (typeof window.Monogatari.init === 'function') {
          engine = window.Monogatari;
          log("âœ… ëŒ€ë¬¸ì Monogatari ì¸ìŠ¤í„´ìŠ¤ í™•ë³´");
        } else if (window.Monogatari.monogatari && typeof window.Monogatari.monogatari.init === 'function') {
          engine = window.Monogatari.monogatari;
          log("âœ… Monogatari.monogatari í•˜ìœ„ ì¸ìŠ¤í„´ìŠ¤ í™•ë³´");
        }
      }

      if (engine) {
        log("ğŸ® ì´ˆê¸°í™” ì‹œë„ ì¤‘...");
        engine.init('#game-screen').then(() => {
          log("ğŸ‰ ì„±ê³µ! ê²Œì„ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.");
          setTimeout(() => document.getElementById('debug-log').style.display = 'none', 2000);
        }).catch(err => {
          log("âŒ ì´ˆê¸°í™” ì‹¤íŒ¨: " + err);
        });
      } else {
        log("âŒ ì—ëŸ¬: ì‹¤í–‰ ê°€ëŠ¥í•œ ì—”ì§„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        log("--- ê²€ì‚¬ ê²°ê³¼ ---");
        log("window.monogatari íƒ€ì…: " + typeof window.monogatari);
        log("window.Monogatari íƒ€ì…: " + typeof window.Monogatari);
        
        // ë°±ì—”ë“œ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê°ì²´ êµ¬ì¡° ë¤í”„
        console.dir({ 
          monogatari: window.monogatari, 
          Monogatari: window.Monogatari 
        });
      }
    });
  </script>
</body>
</html>